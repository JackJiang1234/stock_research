# CninfoCrawler - 巨潮资讯网公告下载器

一个用于从[巨潮资讯网](https://www.cninfo.com.cn)下载上市公司公告文件的命令行工具，支持年报、半年报、季报等多种类型的公告下载。

## 功能特性

- ✅ 支持沪市、深市、北交所股票
- ✅ 支持多种公告分类下载
- ✅ 自动过滤摘要、英文版等非正式报告
- ✅ 断点续传（已存在的文件自动跳过）
- ✅ 按年份和分类整理文件目录

## 环境要求

- .NET 8.0 或更高版本

## 安装

```bash
# 克隆项目
git clone <repository-url>
cd CninfoCrawler

# 还原依赖
dotnet restore

# 编译
dotnet build
```

## 使用方法

### 基本语法

```bash
dotnet run -- <股票代码> [分类1,分类2,...]
```

或者编译后直接运行：

```bash
CninfoCrawler.exe <股票代码> [分类1,分类2,...]
```

### 参数说明

| 参数 | 必填 | 说明 |
|------|------|------|
| 股票代码 | 是 | 6位股票代码，如 600887、000858、300750 |
| 分类 | 否 | 要下载的公告分类，多个分类用逗号分隔，默认为"年度报告,半年度报告" |

### 使用示例

```bash
# 下载伊利股份(600887)的年度报告和半年度报告（默认）
dotnet run -- 600887

# 下载伊利股份(600887)的年度报告
dotnet run -- 600887 年度报告

# 下载伊利股份(600887)的年度报告、半年度报告和首发公告
dotnet run -- 600887 年度报告,半年度报告,首发

# 下载五粮液(000858)的全部季度报告
dotnet run -- 000858 年度报告,一季度报告,半年度报告,三季度报告

# 下载宁德时代(300750)的年度报告
dotnet run -- 300750 年度报告
```

## 支持的公告分类

| 分类名称 | 说明 |
|---------|------|
| 年度报告 | 年度财务报告 |
| 半年度报告 | 中期财务报告 |
| 一季度报告 | 第一季度报告 |
| 三季度报告 | 第三季度报告 |
| 首发 | 首次发行相关 |
| 首次公开发行及上市 | IPO相关公告 |
| 中介报告 | 中介机构出具的专业报告 |
| 股东大会 | 股东大会相关公告 |
| 增发 | 再融资增发相关 |

## 支持的市场

程序会根据股票代码自动判断市场类型：

| 股票代码前缀 | 市场 | 示例 |
|-------------|------|------|
| 600xxx, 601xxx, 603xxx, 605xxx | 沪市主板 | 600887 伊利股份 |
| 688xxx | 科创板 | 688981 中芯国际 |
| 000xxx, 001xxx | 深市主板 | 000858 五粮液 |
| 002xxx | 中小板 | 002594 比亚迪 |
| 300xxx, 301xxx | 创业板 | 300750 宁德时代 |
| 8xxxxx, 4xxxxx | 北交所 | 830799 艾融软件 |

## 文件保存规则

下载的文件将保存在程序运行目录下的 `Downloads` 文件夹中，按以下结构组织：

```
Downloads/
└── {股票代码}/
    ├── 年度报告/
    │   ├── 2024_伊利股份2024年年度报告.PDF
    │   ├── 2023_伊利股份2023年年度报告.PDF
    │   └── ...
    ├── 半年度报告/
    │   ├── 2024_伊利股份2024年半年度报告.PDF
    │   └── ...
    └── 首发/
        └── ...
```

文件命名规则：`{年份}_{公告标题}.PDF`

## 过滤规则

程序会自动过滤以下类型的公告：
- 报告摘要
- 英文版报告
- 修订稿、更正公告
- 补充公告
- 取消公告

## 注意事项

1. 程序会在每次请求之间添加适当的延时，以避免对服务器造成过大压力
2. 已下载的文件不会重复下载，可以安全地多次运行程序
3. 下载大量文件时请耐心等待，年报文件通常较大（几十MB）

## 技术实现

- 使用 `HttpClient` 进行网络请求
- 使用 `Newtonsoft.Json` 解析 API 返回的 JSON 数据
- 调用巨潮资讯网的公告查询 API 获取公告列表
- 从静态资源服务器下载 PDF 文件

## API 参考

本工具调用的巨潮资讯网 API：

- 公告查询：`POST https://www.cninfo.com.cn/new/hisAnnouncement/query`
- 文件下载：`GET https://static.cninfo.com.cn/{adjunctUrl}`

## 许可证

MIT License
